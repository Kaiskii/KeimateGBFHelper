let selectedCombatChara,sSkill=[];showSkillCD=(()=>{if(!isCombat())return;let e=document.querySelectorAll("[ability-id]"),t=[];for(let l=0;l<=3;l++){let i={skills:[]};for(let t=0;t<e.length;t++)if(!0===e[t].outerHTML.includes("ability-character-num-"+(l+1))){let l=e[t].getAttribute("ability-recast");isNullOrUndefined(l)||i.skills.push(l)}t.push(i)}let l=[],i=document.querySelectorAll("div.prt-ability-state");for(let e=0;e<i.length;e++)e<=3&&l.push(i[e]);for(let e=0;e<l.length;e++){let l=0,i=document.querySelectorAll("div.prt-ability-state")[e].childNodes;for(let r=0;r<i.length;r++)if(r%2==1){let a=t[e].skills[l];isNullOrUndefined(a)||("0"===a&&(a=""),i[r].innerHTML='<p style="position: relative;color:black;font-weight:bold;font-size: 6px;text-align: center;top: -4px;text-shadow: 0 0 10px #ffffff, 0 0 10px #ffffff;">'+a+"</p>"),l++}}});const pCA=()=>{if(!isCombat())return;let e=document.querySelector("div.btn-lock.lock1"),t=document.querySelector("div.btn-lock.lock0");!isNullOrUndefined(e)&&simulateClick(e),!isNullOrUndefined(t)&&simulateClick(t)},showBossHP=()=>{if(isCombat())try{let e=stage.pJsnData.boss,t=-1,l=document.querySelectorAll("div.prt-gauge-area")[0].childNodes;l.forEach((l,i)=>{if(!isNullOrUndefined(l.className)&&l.classList.contains("prt-enemy-percent")){t++;let i=numberWithCommas(numberFormat(e.param[t].hp,1)+" / "+numberFormat(e.param[t].hpmax),1),r=(e.param[t].hp/e.param[t].hpmax*100).toFixed(1),a=e.number;e.param.forEach((e,t)=>{0===e.alive&&a--}),a>1?(l.childNodes[1].innerText=r+"%\n ("+i+")",l.childNodes[1].style.cssText="text-shadow: 0 0 1px #731400, 0 0 1px #731400, 0 0 1px #731400, 0 0 1px #731400, 0 0 2px #731400, 0 0 2px #731400, 0 0 2px #731400, 0 0 2px #731400; display: -webkit-box; margin: -34px 0 0 -20px; font-size:12px; width: 200px !important"):(l.childNodes[1].innerText=r+"%\t("+i+")",l.childNodes[1].style.cssText="text-shadow: 0 0 1px #731400, 0 0 1px #731400, 0 0 1px #731400, 0 0 1px #731400, 0 0 2px #731400, 0 0 2px #731400, 0 0 2px #731400, 0 0 2px #731400; display: -webkit-box; margin: -6px 0 0 70px; font-size:15px; width: 300px !important")}})}catch(e){e instanceof ReferenceError&&console.log(e)}};document.addEventListener("click",function(e){!isCombat()||isNullOrUndefined(e.target.parentNode)||isNullOrUndefined(e.target.parentNode.getAttribute("pos"))||(selectedCombatChara={},sSkill=[],selectedCombatChara=e.target.parentNode,setCharaSkill(selectedCombatChara.getAttribute("pos")))});let ready=()=>{if(isCombat()){let e=document.querySelectorAll("[ability-id]");if(e.length>0&&document.querySelectorAll("div.prt-gauge-area")[0].childNodes.length>0){for(let t=0;t<e.length;t++)observer.observe(e[t],{attributes:!0,childList:!0,characterData:!0});let t=document.querySelectorAll("[id^=enemy-hp]");for(let e=0;e<t.length;e++)observer.observe(t[e],{attributes:!0,childList:!0,characterData:!0});try{showSkillCD(),showBossHP()}catch(e){e instanceof ReferenceError&&console.log(e)}}}window.requestAnimationFrame(ready)};window.requestAnimationFrame(ready);const setCharaSkill=e=>{sSkill=[];let t=document.querySelectorAll("div.prt-ability-list")[e].childNodes;sSkill=Object.values(t).filter(e=>{if(!isNullOrUndefined(e.className)&&e.className.includes("btn-ability"))return e})},shortcutSelectChara=e=>{try{simulateClick(document.querySelectorAll("div.lis-character"+e+".btn-command-character")[0]),setCharaSkill(e)}catch(e){}},shortcutSkill=e=>{try{sSkill[e].className.includes("btn-ability-available")&&simulateClick(sSkill[e])}catch(e){}};